"use strict";(self.webpackChunkjob_board_software=self.webpackChunkjob_board_software||[]).push([[2508,1154],{41154:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var r=n(72791),a=n(65764),s=n(57689),o=n(11087),i=n(21830),c=n.n(i),l=n(31243),d=n(12503),u=n(10287),p=n(88329),m=n(80184);function f(){const e=(0,a.useStripe)(),t=(0,a.useElements)(),n=(0,s.s0)();let i={transaction_id:""};const[f,y]=(0,r.useState)(null),[g,h]=(0,r.useState)(!1),[w,x]=(0,r.useState)(!1),{slug:S}=(0,s.UO)(),v=p.Z.get("user_type"),j=p.Z.get("tokenClient");(0,r.useEffect)((()=>{if(!e)return;const t=new URLSearchParams(window.location.search).get("payment_intent_client_secret");t&&e.retrievePaymentIntent(t).then((e=>{let{paymentIntent:t}=e;switch(t.status){case"succeeded":y("Payment succeeded!");const e=function(){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let t="";for(let n=0;n<17;n++){const n=Math.floor(62*Math.random());t+=e.charAt(n)}return t}();console.log(e),(async e=>{try{if(e){var t=sessionStorage.getItem("prePaymentSlug");i.transaction_id=e,await l.Z.post(d.Z+`/payments/checkoutSuccess/${t}`,i,{headers:{"Content-Type":"application/json",key:u.Z,token:j}})}else console.log("Failed to generate order ID")}catch(n){console.log("Error in handle success api")}})(e),c().fire({title:"Payment succeeded!",icon:"success",confirmButtonText:"Close"}),"candidate"===v&&n("/candidates/myaccount"),"recruiter"===v&&n("/user/myprofile");break;case"processing":y("Your payment is processing."),c().fire({title:"Your payment is processing",icon:"warning",confirmButtonText:"Close"}),"candidate"===v&&n("/candidates/myaccount"),"recruiter"===v&&n("/user/myprofile");break;case"requires_payment_method":y("Your payment was not successful, please try again."),c().fire({title:"Your payment was not successful, please try again",icon:"error",confirmButtonText:"Close"}),"candidate"===v&&n("/candidates/myaccount"),"recruiter"===v&&n("/user/myprofile");break;default:y("Something went wrong."),c().fire({title:"Something went wrong",icon:"error",confirmButtonText:"Close"}),"candidate"===v&&n("/candidates/myaccount"),"recruiter"===v&&n("/user/myprofile")}}))}),[e]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"stripeFormBox",style:{padding:"40px",margin:"auto",marginTop:"200px",width:"600px",boxShadow:"rgba(0, 0, 0, 0.24) 0px 3px 8px",borderRadius:"5px",display:`${w} && none`},children:(0,m.jsxs)("form",{id:"payment-form",onSubmit:async n=>{if(n.preventDefault(),!e||!t)return;h(!0);const{error:r}=await e.confirmPayment({elements:t,confirmParams:{return_url:`https://job-board-software.logicspice.com/payment/paymentoption/${S}`}});"card_error"===r.type||"validation_error"===r.type?(y(r.message),c().fire({title:r.message,icon:"warning",confirmButtonText:"Close"})):(console.log(r.message),c().fire({title:r.message,icon:"warning",confirmButtonText:"Close"}),y("An unexpected error occurred.")),h(!1)},children:[(0,m.jsx)(a.PaymentElement,{id:"payment-element",options:{layout:"tabs"}}),(0,m.jsx)("button",{className:"payButtonStripe",disabled:g||!e||!t,id:"submit",children:(0,m.jsx)("span",{id:"button-text",children:g?(0,m.jsx)("div",{className:"spinner",id:"spinner"}):"Pay now"})})]})}),f&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{id:"payment-message",className:"stripePaymentMessage"}),(0,m.jsx)(o.rU,{to:"candidate"===v?"/candidates/myaccount":"/user/myprofile",className:"navButton1",children:"My Profile"})]})]})}},82508:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var r=n(72791),a=n(65764),s="https://js.stripe.com/v3",o=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,i="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",c=null,l=function(e){return null!==c||(c=new Promise((function(t,n){if("undefined"!==typeof window&&"undefined"!==typeof document)if(window.Stripe&&e&&console.warn(i),window.Stripe)t(window.Stripe);else try{var r=function(){for(var e=document.querySelectorAll('script[src^="'.concat(s,'"]')),t=0;t<e.length;t++){var n=e[t];if(o.test(n.src))return n}return null}();r&&e?console.warn(i):r||(r=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(s).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(n),n}(e)),r.addEventListener("load",(function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))})),r.addEventListener("error",(function(){n(new Error("Failed to load Stripe.js"))}))}catch(a){return void n(a)}else t(null)}))),c},d=Promise.resolve().then((function(){return l(null)})),u=!1;d.catch((function(e){u||console.warn(e)}));var p=n(41154),m=n(12503),f=n(10287),y=n(88329),g=n(57689),h=n(31243),w=n(80184);const x=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];u=!0;var r=Date.now();return d.then((function(e){return function(e,t,n){if(null===e)return null;var r=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"2.2.0",startTime:t})}(r,n),r}(e,t,r)}))}(y.Z.get("stripe_pk")),S=()=>{const[e,t]=(0,r.useState)(""),n=y.Z.get("tokenClient"),s=y.Z.get("user_type"),o=(0,g.s0)(),{slug:i}=(0,g.UO)();(0,r.useEffect)((()=>{fetch(m.Z+"/payments/PayWithStripe",{method:"POST",headers:{"Content-Type":"application/json",key:f.Z,token:n},body:JSON.stringify({plan_id:i,payment_option:"stripe"})}).then((e=>e.json())).then((e=>t(e.clientSecret)))}),[]);let c="";(0,r.useEffect)((()=>{(async e=>{try{const t=await h.Z.post(m.Z+"/payments/planpurchase",{plan_id:e,payment_option:"stripe"},{headers:{"Content-Type":"application/json",key:f.Z,token:n}});200===t.data.status?c=t.data.response.slug:("candidate"===s&&o("/candidates/myaccount"),"recruiter"===s&&o("/user/myprofile")),sessionStorage.setItem("prePaymentSlug",c)}catch(t){console.error("Error fetching data:",t)}})(i)}),[]);const l={clientSecret:e,appearance:{theme:"stripe"}};return(0,w.jsx)("div",{children:e?(0,w.jsx)(a.Elements,{options:l,stripe:x,children:(0,w.jsx)(p.default,{})}):(0,w.jsx)(w.Fragment,{children:(0,w.jsx)("div",{className:"pleaseWaitStripe",children:(0,w.jsx)("img",{src:"/Images/credit-card.gif",alt:"payment"})})})})}}}]);
//# sourceMappingURL=2508.ddf9340f.chunk.js.map