"use strict";(self.webpackChunkjob_board_software=self.webpackChunkjob_board_software||[]).push([[5544],{55544:(e,s,t)=>{t.r(s),t.d(s,{default:()=>v});var a=t(72791),l=t(65167),r=t(93953),n=t(20890),i=t(93517),o=t(50533),c=t(98333),d=t(31243),m=t(12503),u=t(10287),p=t(21830),h=t.n(p),j=t(57689),x=t(88329),b=t(89868),y=t(24529),N=t(80184);const v=()=>{const[e,s]=(0,a.useState)({usertype:"",template_id:"",jobseekstatus:1,empstatus:1,jobseekers:1,employers:1}),[t,p]=(0,a.useState)({usertype:"",template_id:"",jobseekstatus:"",empstatus:"",jobseekers:"",employers:""}),[v,f]=(0,a.useState)(!1),[S,g]=(0,a.useState)([]),[k,w]=(0,a.useState)([]),[C,B]=(0,a.useState)([]),[T,P]=(0,a.useState)(!1),[_,Z]=(0,a.useState)(!1),D=x.Z.get("token"),E=x.Z.get("adminID"),[F,R]=(0,a.useState)(""),A=(0,j.s0)(),I=t=>{const{name:a,value:l}=t.target;if("usertype"===a){const e=t.target.value;R(e),"recruiter"===e&&"2"===l?(P(!0),Z(!1)):"candidate"===e&&"2"===l?(P(!1),Z(!0)):(P(!1),Z(!1))}if("empstatus"===a){"2"===t.target.value&&(P(!0),Z(!1))}if("jobseekstatus"===a){"2"===t.target.value&&(Z(!0),P(!1))}s((e=>({...e,[a]:l}))),p((e=>({...e,[a]:""}))),console.log(e)},J=async()=>{try{f(!0);const e=await d.Z.post(m.Z+"/admin/newsletter/admin_sendNewsletter",null,{headers:{"Content-Type":"application/json",key:u.Z,token:D,adminid:E}});f(!1),s(e.data.response),g(e.data.response.templates),w(e.data.response.employerUserList),B(e.data.response.jobseekerUserList)}catch(e){console.log("Error at SMTP data fetching")}};(0,a.useEffect)((()=>{D?(J(),window.scrollTo(0,0)):A("/admin")}),[D,A]);const[q,U]=(0,a.useState)([]),[M,L]=(0,a.useState)([]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(l.Z,{}),(0,N.jsxs)("div",{className:"APBasic",children:[(0,N.jsx)(r.Z,{}),v?(0,N.jsx)(N.Fragment,{children:(0,N.jsx)("div",{className:"loader-container"})}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"site-min-height",children:[(0,N.jsx)("div",{className:"breadCumb1",role:"presentation",children:(0,N.jsxs)(i.Z,{"aria-label":"breadcrumb",separator:(0,N.jsx)(c.Z,{fontSize:"small"}),children:[(0,N.jsx)(o.Z,{underline:"hover",color:"inherit",onClick:()=>A("/admin/admins/dashboard"),children:"Dashboard"}),(0,N.jsx)(o.Z,{underline:"hover",color:"inherit",onClick:()=>A("/admin/newsletters/index"),children:"Newsletter"}),(0,N.jsx)(n.Z,{color:"text.primary",children:"Send Newsletter to Newsletter Subscribers"})]})}),(0,N.jsx)("h2",{className:"adminPageHeading",children:"Send Newsletter to Newsletter Subscribers"}),(0,N.jsx)("form",{className:"adminForm",children:(0,N.jsxs)("div",{className:"mb-4 mt-5",children:[(0,N.jsxs)("div",{class:"mb-5 DashBoardInputBx",children:[(0,N.jsxs)("label",{for:"formFile",class:"form-label",children:["Select Newsletter Template",(0,N.jsx)("span",{className:"RedStar",children:"*"})]}),(0,N.jsxs)("select",{className:`form-select ${t.template_id&&"input-error"}`,"aria-label":"Default select example",name:"template_id",value:e.template_id,onChange:I,children:[(0,N.jsx)("option",{value:"",children:"Select Newsletter Template"}),S.map((e=>(0,N.jsx)("option",{value:e.id,children:e.subject})))]}),t.template_id&&(0,N.jsx)("div",{className:"text-danger",children:t.template_id})]}),(0,N.jsxs)("div",{className:"mb-5 DashBoardInputBx",children:[(0,N.jsxs)("label",{className:"form-label",htmlFor:"userTypeSelect",children:["Select User Type",(0,N.jsx)("span",{className:"RedStar",children:"*"})]}),(0,N.jsxs)("div",{className:"APPaymentDetailsRadio",children:[(0,N.jsxs)("select",{id:"userTypeSelect",className:"form-select "+(t.usertype?"input-error":""),name:"usertype",value:e.usertype,onChange:I,children:[(0,N.jsx)("option",{selected:!0,value:"",children:"Select User Type"}),(0,N.jsx)("option",{value:"recruiter",children:"Employer"}),(0,N.jsx)("option",{value:"candidate",children:"Jobseeker"})]}),t.usertype&&(0,N.jsx)("div",{className:"text-danger",children:t.usertype})]})]}),"recruiter"===e.usertype&&(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)("div",{className:"mb-5 DashBoardInputBx",children:[(0,N.jsxs)("label",{className:"form-label",htmlFor:"emailTypeSelect",children:["Select Sharing Option",(0,N.jsx)("span",{className:"RedStar",children:"*"})]}),(0,N.jsxs)("div",{className:"APPaymentDetailsRadio",children:[(0,N.jsxs)("select",{id:"emailTypeSelect",className:"form-select "+(t.empstatus?"input-error":""),name:"empstatus",value:e.empstatus,onChange:I,children:[(0,N.jsx)("option",{selected:!0,value:"",children:"Select sharing option"}),(0,N.jsx)("option",{value:"1",children:"Send Newsletter to all Employers"}),(0,N.jsx)("option",{value:"2",children:"Select Employers to Send a Newsletter"})]}),t.empstatus&&(0,N.jsx)("div",{className:"text-danger",children:t.empstatus})]})]})}),"candidate"===e.usertype&&(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)("div",{className:"mb-5 DashBoardInputBx",children:[(0,N.jsxs)("label",{className:"form-label",htmlFor:"emailTypeSelect",children:["Select Sharing Option",(0,N.jsx)("span",{className:"RedStar",children:"*"})]}),(0,N.jsxs)("div",{className:"APPaymentDetailsRadio",children:[(0,N.jsxs)("select",{id:"emailTypeSelect",className:"form-select "+(t.jobseekstatus?"input-error":""),name:"jobseekstatus",value:e.jobseekstatus,onChange:I,children:[(0,N.jsx)("option",{selected:!0,value:"",children:"Select sharing option"}),(0,N.jsx)("option",{value:"1",children:"Send Newsletter to all Jobseekers"}),(0,N.jsx)("option",{value:"2",children:"Select Jobseekers to send a Newsletter"})]}),t.jobseekstatus&&(0,N.jsx)("div",{className:"text-danger",children:t.jobseekstatus})]})]})}),"2"===e.empstatus&&T&&(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)("div",{class:"mb-5 DashBoardInputBx DashBoardCreatBx skillPackage APJoditEditor",children:[(0,N.jsxs)("label",{for:"formFile",class:"form-label",children:["Select Employers",(0,N.jsx)("span",{className:"RedStar",children:"*"})]}),(0,N.jsx)(b.ZP,{isMulti:!0,isSearchable:!0,name:"employers",options:k.map((e=>({value:e.email_address,label:e.email_address}))),className:"basic-multi-select",value:q,classNamePrefix:"select",onChange:e=>{U(e),e.length>0&&p((e=>({...e,skill:""})))}}),t.employers&&(0,N.jsx)("div",{className:"text-danger",children:t.employers})]})}),"2"===e.jobseekstatus&&_&&(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)("div",{class:"mb-5 DashBoardInputBx DashBoardCreatBx skillPackage APJoditEditor",children:[(0,N.jsxs)("label",{for:"formFile",class:"form-label",children:["Select Jobseekers ",(0,N.jsx)("span",{className:"RedStar",children:"*"})]}),(0,N.jsx)(b.ZP,{isMulti:!0,isSearchable:!0,name:"jobseekers",options:C.map((e=>({value:e.email_address,label:e.first_name+" "+e.last_name}))),className:"basic-multi-select",value:M,classNamePrefix:"select",onChange:e=>{L(e),e.length>0&&p((e=>({...e,skill:""})))}}),t.jobseekers&&(0,N.jsx)("div",{className:"text-danger",children:t.jobseekers})]})}),(0,N.jsx)("button",{type:"button",className:"btn btn-primary button1",onClick:async()=>{var a=document.getElementsByName("employers"),l=document.getElementsByName("jobseekers"),r=[],n=[];a.forEach((e=>{r.push(e.value)})),l.forEach((e=>{n.push(e.value)})),console.log(r),s({...e,employers:r,jobseekers:n});try{const{usertype:s,template_id:a,jobseekstatus:l,empstatus:i,jobseekers:o,employers:c}=e;if(!s||!a)return void p({usertype:s?"":"Usertype is required",template_id:a?"":"Newsletter template is required"});if("recruiter"===s&&!i)return void p({empstatus:i?"":"Email type is required"});if("candidate"===s&&!l)return void p({jobseekstatus:l?"":"Email type is required"});if("recruiter"===s&&"2"===e.empstatus&&0===q.length)return console.log("here"),void p({employers:"Please select employers"});if("candidate"===s&&"2"===l&&0===M.length)return void p({jobseekers:"Jobseekers is required"});if(t.length>0)return;if((await h().fire({title:"Send?",text:"Do you want to send newsletter to subscribers?",icon:"question",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No"})).isConfirmed){const s={...e,employers:r,jobseekers:n},t=await d.Z.post(m.Z+"/admin/newsletter/admin_sendNewsletter",s,{headers:{"Content-Type":"application/json",key:u.Z,token:D,adminid:E}});200===t.data.status?(h().fire({title:"Newsletter sent successfully!",icon:"success",confirmButtonText:"Close"}),J(),window.scrollTo(0,0)):h().fire({title:t.data.message,icon:"error",confirmButtonText:"Close"})}}catch(i){h().fire({title:"Failed",text:"Could not send newsletter. Please try again later!",icon:"error",confirmButtonText:"Close"}),console.log("Could not update SMTP Settings!",i)}},children:"SEND"}),(0,N.jsx)("button",{type:"button",className:"btn btn-primary button2",onClick:()=>A("/admin/newsletters/index"),children:"CANCEL"})]})})]}),(0,N.jsx)(y.Z,{})]})]})]})}}}]);
//# sourceMappingURL=5544.56840d64.chunk.js.map